{% extends "base.html" %}
{% block content %}
<div class="d-flex flex-wrap justify-content-between align-items-end mb-3">
  <h2 class="h3 mb-0">Explore Goa</h2>
  <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('ar_view') }}">Open AR</a>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-md-6">
    <input name="q" class="form-control" placeholder="Search by name or area" value="{{ q or '' }}">
  </div>
  <div class="col-md-4">
    <select name="category" class="form-select">
      <option value="">All categories</option>
      {% for c in ["Beach", "Fort", "Church", "Waterfall", "Viewpoint", "Market"] %}
        <option value="{{ c }}" {% if category==c.lower() %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-2 d-grid">
    <button class="btn btn-primary" type="submit">Filter</button>
  </div>
</form>

<div class="row g-4">
  <div class="col-lg-6">
    <div id="map" style="height: 480px;" class="rounded-4 overflow-hidden shadow-sm"></div>
  </div>
  <div class="col-lg-6">
    <div class="row row-cols-1 row-cols-md-2 g-3" id="poi-cards">
      {% for p in pois %}
      <div class="col">
        <div class="card h-100 rounded-4 shadow-sm">
          <img src="{{ p['image'] }}" class="card-img-top" alt="{{ p['name'] }}">
          <div class="card-body">
            <h5 class="card-title">{{ p['name'] }}</h5>
            <p class="card-text small text-muted mb-2">{{ p['area'] }} â€¢ {{ p['category'] }}</p>
            <p class="card-text">{{ p['blurb'] }}</p>
            <a href="{{ url_for('poi_detail', poi_id=p['id']) }}" class="btn btn-sm btn-primary">Details</a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  window.__INITIAL_POI__ = {{ pois|tojson }};
</script>
{% endblock %}